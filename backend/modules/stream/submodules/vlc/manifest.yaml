id: vlc
name: "VLC Player Driver"
version: "1.0.0"
priority: 20
author: NMS-Team
description: Модуль для работы с VLC (cvlc). Использует мощный движок VideoLAN для вещания.
entrypoints: {}

capabilities:
  - streaming
  - preview

config_schema:
  type: object
  properties:
    # ── Система ──
    binary_path:
      type: string
      title: "Путь к VLC (cvlc)"
      default: "cvlc"
      description: "Системный путь к исполняемому файлу VLC."
      group: "Система"

    # ── Плеер ──
    http_port:
      type: integer
      title: "HTTP Порт вещания"
      minimum: 1024
      maximum: 65535
      default: 8081
      description: "Порт для раздачи потока по протоколу HTTP."
      group: "Плеер (HTTP_TS)"
    http_mux:
      type: string
      title: "Контейнер (Muxer)"
      enum: ["ts", "ogg", "ps"]
      default: "ts"
      description: "Формат упаковки потока."
      group: "Плеер (HTTP_TS)"

    # ── Плеер (HLS) ──
    hls_seglen:
      type: integer
      title: "HLS: Длительность сегмента"
      minimum: 1
      maximum: 30
      default: 5
      description: "Видео-фрагмент (сек)."
      group: "Плеер (HLS)"
    hls_numfiles:
      type: integer
      title: "HLS: Размер плейлиста"
      minimum: 1
      maximum: 50
      default: 5
      description: "Количество файлов в плейлисте."
      group: "Плеер (HLS)"

    # ── Превью ──
    scene_ratio:
      type: integer
      title: "Интервал кадров"
      minimum: 1
      maximum: 100
      default: 10
      description: "Захватывать каждый N-ый кадр."
      group: "Превью"
    scene_run_time:
      type: integer
      title: "Время работы (сек)"
      minimum: 1
      maximum: 30
      default: 5
      description: "Время ожидания VLC для захвата снимка."
      group: "Превью"

    # ── Экспертные настройки ──
    override_http_ts:
      type: string
      title: "Override: HTTP_TS"
      default: ""
      description: "Кастомные аргументы VLC для вещания."
      group: "Для экспертов"
    override_hls:
      type: string
      title: "Override: HLS"
      default: ""
      description: "Кастомные аргументы VLC для HLS."
      group: "Для экспертов"

# Поддерживаемые форматы и протоколы
formats:
  input_protocols:
    - udp
    - http
    - rtsp
  output_types:
    - http_ts
    - hls
  preview_formats:
    - jpeg
    - png
