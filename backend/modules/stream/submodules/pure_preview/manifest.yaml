id: pure_preview
parent: stream
name: Pure Preview (Native)
version: 1.0.0
priority: 80
author: NMS-Team
description: Нативный Python-генератор превью на базе Pillow. Извлекает кадры из MPEG-TS.
entrypoints: {}

capabilities:
  - preview

# Настройки бэкенда, сгруппированные по связкам
config_schema:
  type: object
  properties:
    # ── Превью Pipeline ──
    timeout:
      type: integer
      title: "Таймаут входа (сек)"
      minimum: 1
      maximum: 60
      default: 15
      description: "Время ожидания первого MPEG-TS пакета"
      group: "Превью"
    initial_buffer_size:
      type: integer
      title: "Размер буфера (байт)"
      minimum: 65536
      maximum: 16777216
      default: 2097152
      description: "Объем данных для поиска I-кадра"
      group: "Превью"
    resize_method:
      type: string
      title: "Метод ресайза"
      enum: ["LANCZOS", "BILINEAR", "BICUBIC", "NEAREST"]
      default: "LANCZOS"
      description: "Алгоритм масштабирования Pillow"
      group: "Превью"
    output_format:
      type: string
      title: "Формат записи"
      enum: ["JPEG", "PNG", "WEBP"]
      default: "JPEG"
      description: "Формат сохраняемого файла скриншота"
      group: "Превью"

# Поддерживаемые форматы и протоколы
formats:
  input_protocols:
    - http
    - hls
    - udp
  output_types: []
  preview_formats:
    - jpeg
    - png
    - webp
