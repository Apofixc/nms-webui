# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –º–æ–¥—É–ª–µ–π NMS-WebUI

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π (–ø–ª–∞–≥–∏–Ω–æ–≤) –¥–ª—è —Å–∏—Å—Ç–µ–º—ã NMS-WebUI. –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å —è–≤–ª—è–µ—Ç—Å—è "–ø–ª–∞–≥–∏–Ω–æ–º", –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –±—ç–∫–µ–Ω–¥-–ª–æ–≥–∏–∫—É, API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

---

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è

–í—Å–µ –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `backend/modules/<module_id>/`.

–¢–∏–ø–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
```text
backend/modules/<module_id>/
‚îú‚îÄ‚îÄ manifest.yaml      # ‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª: –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª—è, –ø—É—Ç–µ–π –∏ UI
‚îú‚îÄ‚îÄ __init__.py        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ module.py          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –º–æ–¥—É–ª—è (–Ω–∞—Å–ª–µ–¥—É–µ—Ç BaseModule)
‚îú‚îÄ‚îÄ api.py             # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–æ–≤ FastAPI
‚îú‚îÄ‚îÄ services.py        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –º–æ–¥—É–ª—è
‚îî‚îÄ‚îÄ models.py          # Pydantic –∏ DB –º–æ–¥–µ–ª–∏
```

---

## üìú 1. –°–æ–∑–¥–∞–Ω–∏–µ manifest.yaml

`manifest.yaml` ‚Äî —ç—Ç–æ "–µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã" –¥–ª—è —Å–∏—Å—Ç–µ–º—ã. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±—ç–∫–µ–Ω–¥–æ–º –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–∏–∫–∏ –∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–µ–Ω—é –∏ —Ä–æ—É—Ç–æ–≤.

–ü—Ä–∏–º–µ—Ä –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ (`backend/modules/notifications/manifest.yaml`):

```yaml
id: notifications              # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (kebab-case)
name: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è              # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è
version: 1.0.0
description: –ú–æ–¥—É–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —Ä–∞—Å—Å—ã–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
enabled_by_default: true

deps: []                       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π [module-id]

entrypoints:
  factory: "backend.modules.notifications:create_module" # Python-–ø—É—Ç—å –∫ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è
  router: "backend.modules.notifications.api:router"     # –ü—É—Ç—å –∫ FastAPI —Ä–æ—É—Ç–µ—Ä—É

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
config_schema:
  type: object
  properties:
    email_enabled:
      type: boolean
      default: true
    max_history:
      type: integer
      default: 100

# –û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ—É—Ç–æ–≤ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
routes:
  - path: "/notifications"
    name: "notifications-index"
    meta:
      title: "–ñ—É—Ä–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
      icon: "bell"             # –ò–º—è –∏–∫–æ–Ω–∫–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–Ω–∞–ø—Ä. Lucide)
      group: "–°–∏—Å—Ç–µ–º–∞"
      requires_auth: true
      permissions: ["notifications.read"]

# –ú–µ–Ω—é –≤ —Å–∞–π–¥–±–∞—Ä–µ
menu:
  location: sidebar
  group: "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"
  items:
    - path: "/notifications"
      label: "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
      icon: "bell"
```

---

## üêç 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ (–ë—ç–∫–µ–Ω–¥)

### –ö–ª–∞—Å—Å –º–æ–¥—É–ª—è (`module.py`)

–ú–æ–¥—É–ª—å –¥–æ–ª–∂–µ–Ω –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –æ—Ç `BaseModule` –∏ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª.

```python
from backend.modules.base import BaseModule
from typing import Any

class NotificationsModule(BaseModule):
    def init(self) -> None:
        # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–Ω–µ–∫—Ç–æ–≤
        print(f"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è {self.context.id}")

    def start(self) -> None:
        # –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á, –ø–æ–¥–ø–∏—Å–∫–∏
        pass

    def stop(self) -> None:
        # –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
        pass

    def get_status(self) -> dict[str, Any]:
        return {"active": True, "processed_count": 42}
```

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (`__init__.py`)

–§—É–Ω–∫—Ü–∏—è `create_module` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–º –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º:

```python
from backend.core.plugin.context import ModuleContext
from .module import NotificationsModule

def create_module(ctx: ModuleContext) -> NotificationsModule:
    return NotificationsModule(ctx)
```

### API (`api.py`)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—ã—á–Ω—ã–µ —Ä–æ—É—Ç–µ—Ä—ã FastAPI. –û–Ω–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã (mounted) —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `/api/v1/m/<module_id>`.

```python
from fastapi import APIRouter

router = APIRouter()

@router.get("/")
async def get_notifications():
    return [{"id": 1, "text": "–°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞"}]
```

---

## üé® 3. –§—Ä–æ–Ω—Ç–µ–Ω–¥

–§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ NMS-WebUI —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏. –í–∞–º **–Ω–µ –Ω—É–∂–Ω–æ** –≤—Ä—É—á–Ω—É—é –ø—Ä–∞–≤–∏—Ç—å `router.ts` –≤ —è–¥—Ä–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç —á–µ—Ä–µ–∑ `/api/modules`.
2. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—É—Ç–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –±–ª–æ–∫–µ `routes:`.
3. –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é –≤ —Å–∞–π–¥–±–∞—Ä–µ –∏–∑ –±–ª–æ–∫–∞ `menu:`.

–î–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –º–æ–¥—É–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `ModuleView.vue`, –≤ –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ –ø–∞–ø–∫–∏ –º–æ–¥—É–ª—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–µ—Å–ª–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞ —Å–ª–æ–∂–Ω–∞—è) –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ `config_schema`.

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **Scaffold Script**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/scripts/scaffold.py notifications` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —à–∞–±–ª–æ–Ω–∞ –º–æ–¥—É–ª—è (–±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ).
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `/scripts/validate.py`, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `manifest.yaml` –Ω–∞ –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.
